"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("graphql/language/visitor"),t=require("ts-invariant"),r=require("tslib"),i=e(require("fast-json-stable-stringify"));function o(e){return["StringValue","BooleanValue","EnumValue"].indexOf(e.kind)>-1}function u(e){return["IntValue","FloatValue"].indexOf(e.kind)>-1}function a(e){return"StringValue"===e.kind}function c(e){return"BooleanValue"===e.kind}function f(e){return"IntValue"===e.kind}function l(e){return"FloatValue"===e.kind}function s(e){return"Variable"===e.kind}function v(e){return"ObjectValue"===e.kind}function p(e){return"ListValue"===e.kind}function m(e){return"EnumValue"===e.kind}function d(e){return"NullValue"===e.kind}function g(e,n,r,i){if(f(r)||l(r))e[n.value]=Number(r.value);else if(c(r)||a(r))e[n.value]=r.value;else if(v(r)){var o={};r.fields.map(function(e){return g(o,e.name,e.value,i)}),e[n.value]=o}else if(s(r)){var u=(i||{})[r.name.value];e[n.value]=u}else if(p(r))e[n.value]=r.values.map(function(e){var t={};return g(t,n,e,i),t[n.value]});else if(m(r))e[n.value]=r.value;else{if(!d(r))throw new t.InvariantError(17);e[n.value]=null}}function y(e,n){var t=null;e.directives&&(t={},e.directives.forEach(function(e){t[e.name.value]={},e.arguments&&e.arguments.forEach(function(r){var i=r.name,o=r.value;return g(t[e.name.value],i,o,n)})}));var r=null;return e.arguments&&e.arguments.length&&(r={},e.arguments.forEach(function(e){var t=e.name,i=e.value;return g(r,t,i,n)})),b(e.name.value,r,t)}var h=["connection","include","skip","client","rest","export"];function b(e,n,t){if(t&&t.connection&&t.connection.key){if(t.connection.filter&&t.connection.filter.length>0){var r=t.connection.filter?t.connection.filter:[];r.sort();var o=n,u={};return r.forEach(function(e){u[e]=o[e]}),t.connection.key+"("+JSON.stringify(u)+")"}return t.connection.key}var a=e;if(n){var c=i(n);a+="("+c+")"}return t&&Object.keys(t).forEach(function(e){-1===h.indexOf(e)&&(t[e]&&Object.keys(t[e]).length?a+="@"+e+"("+JSON.stringify(t[e])+")":a+="@"+e)}),a}function x(e,n){if(e.arguments&&e.arguments.length){var t={};return e.arguments.forEach(function(e){var r=e.name,i=e.value;return g(t,r,i,n)}),t}return null}function O(e){return e.alias?e.alias.value:e.name.value}function D(e){return"Field"===e.kind}function k(e){return"InlineFragment"===e.kind}function F(e){return e&&"id"===e.type&&"boolean"==typeof e.generated}function j(e,n){return void 0===n&&(n=!1),r.__assign({type:"id",generated:n},"string"==typeof e?{id:e,typename:void 0}:e)}function S(e){return null!=e&&"object"==typeof e&&"json"===e.type}function E(e){throw new t.InvariantError(18)}function V(e,n){switch(void 0===n&&(n=E),e.kind){case"Variable":return n(e);case"NullValue":return null;case"IntValue":return parseInt(e.value,10);case"FloatValue":return parseFloat(e.value);case"ListValue":return e.values.map(function(e){return V(e,n)});case"ObjectValue":for(var t={},r=0,i=e.fields;r<i.length;r++){var o=i[r];t[o.name.value]=V(o.value,n)}return t;default:return e.value}}function _(e,n){if(e.directives&&e.directives.length){var t={};return e.directives.forEach(function(e){t[e.name.value]=x(e,n)}),t}return null}function w(e,n){return void 0===n&&(n={}),A(e.directives).every(function(e){var r=e.directive,i=e.ifArgument,o=!1;return"Variable"===i.value.kind?(o=n[i.value.name.value],t.invariant(void 0!==o,1)):o=i.value.value,"skip"===r.name.value?!o:o})}function I(e){var t=[];return n.visit(e,{Directive:function(e){t.push(e.name.value)}}),t}function N(e,n){return I(n).some(function(n){return e.indexOf(n)>-1})}function q(e){return e&&N(["client"],e)&&N(["export"],e)}function P(e){var n=e.name.value;return"skip"===n||"include"===n}function A(e){return e?e.filter(P).map(function(e){var n=e.arguments;e.name.value;t.invariant(n&&1===n.length,2);var r=n[0];t.invariant(r.name&&"if"===r.name.value,3);var i=r.value;return t.invariant(i&&("Variable"===i.kind||"BooleanValue"===i.kind),4),{directive:e,ifArgument:r}}):[]}function M(e,n){var i=n,o=[];return e.definitions.forEach(function(e){if("OperationDefinition"===e.kind)throw new t.InvariantError(5);"FragmentDefinition"===e.kind&&o.push(e)}),void 0===i&&(t.invariant(1===o.length,6),i=o[0].name.value),r.__assign({},e,{definitions:[{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:i}}]}}].concat(e.definitions)})}function T(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return n.forEach(function(n){null!=n&&Object.keys(n).forEach(function(t){e[t]=n[t]})}),e}function J(e){L(e);var n=e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})[0];return t.invariant(n,7),n}function L(e){t.invariant(e&&"Document"===e.kind,8);var n=e.definitions.filter(function(e){return"FragmentDefinition"!==e.kind}).map(function(e){if("OperationDefinition"!==e.kind)throw new t.InvariantError(9);return e});return t.invariant(n.length<=1,10),e}function Q(e){return L(e),e.definitions.filter(function(e){return"OperationDefinition"===e.kind})[0]}function z(e){var n=Q(e);return t.invariant(n,11),n}function B(e){return e.definitions.filter(function(e){return"OperationDefinition"===e.kind&&e.name}).map(function(e){return e.name.value})[0]||null}function C(e){return e.definitions.filter(function(e){return"FragmentDefinition"===e.kind})}function K(e){var n=Q(e);return t.invariant(n&&"query"===n.operation,12),n}function R(e){t.invariant("Document"===e.kind,13),t.invariant(e.definitions.length<=1,14);var n=e.definitions[0];return t.invariant("FragmentDefinition"===n.kind,15),n}function W(e){var n;L(e);for(var r=0,i=e.definitions;r<i.length;r++){var o=i[r];if("OperationDefinition"===o.kind){var u=o.operation;if("query"===u||"mutation"===u||"subscription"===u)return o}"FragmentDefinition"!==o.kind||n||(n=o)}if(n)return n;throw new t.InvariantError(16)}function H(e){void 0===e&&(e=[]);var n={};return e.forEach(function(e){n[e.name.value]=e}),n}function U(e){if(e&&e.variableDefinitions&&e.variableDefinitions.length){var n=e.variableDefinitions.filter(function(e){return e.defaultValue}).map(function(e){var n=e.variable,t=e.defaultValue,r={};return g(r,n.name,t),r});return T.apply(void 0,[{}].concat(n))}return{}}function G(e){var n=new Set;if(e.variableDefinitions)for(var t=0,r=e.variableDefinitions;t<r.length;t++){var i=r[t];n.add(i.variable.name.value)}return n}function X(e,n,t){var r=0;return e.forEach(function(t,i){n.call(this,t,i,e)&&(e[r++]=t)},t),e.length=r,e}var Y={kind:"Field",name:{kind:"Name",value:"__typename"}};function Z(e,n){return e.selectionSet.selections.every(function(e){return"FragmentSpread"===e.kind&&Z(n[e.name.value],n)})}function $(e){return Z(Q(e)||R(e),H(C(e)))?null:e}function ee(e){return function(n){return e.some(function(e){return e.name&&e.name===n.name.value||e.test&&e.test(n)})}}function ne(e,t){var r=Object.create(null),i=[],o=Object.create(null),u=[],a=$(n.visit(t,{Variable:{enter:function(e,n,t){"VariableDefinition"!==t.kind&&(r[e.name.value]=!0)}},Field:{enter:function(n){if(e&&n.directives&&(e.some(function(e){return e.remove})&&n.directives&&n.directives.some(ee(e))))return n.arguments&&n.arguments.forEach(function(e){"Variable"===e.value.kind&&i.push({name:e.value.name.value})}),n.selectionSet&&se(n.selectionSet).forEach(function(e){u.push({name:e.name.value})}),null}},FragmentSpread:{enter:function(e){o[e.name.value]=!0}},Directive:{enter:function(n){if(ee(e)(n))return null}}}));return a&&X(i,function(e){return!r[e.name]}).length&&(a=fe(i,a)),a&&X(u,function(e){return!o[e.name]}).length&&(a=le(u,a)),a}function te(e){return n.visit(L(e),{SelectionSet:{enter:function(e,n,t){if(!t||"OperationDefinition"!==t.kind){var i=e.selections;if(i)if(!i.some(function(e){return D(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))})){var o=t;if(!(D(o)&&o.directives&&o.directives.some(function(e){return"export"===e.name.value})))return r.__assign({},e,{selections:i.concat([Y])})}}}}})}var re={test:function(e){var n="connection"===e.name.value;return n&&(!e.arguments||e.arguments.some(function(e){return"key"===e.name.value})),n}};function ie(e){return ne([re],L(e))}function oe(e,n,t){return void 0===t&&(t=!0),n&&n.selections&&n.selections.some(function(n){return ue(e,n,t)})}function ue(e,n,t){return void 0===t&&(t=!0),!D(n)||!!n.directives&&(n.directives.some(ee(e))||t&&oe(e,n.selectionSet,t))}function ae(e,t){var i;return L(t),$(n.visit(t,{SelectionSet:{enter:function(n,t,o,u){var a=u.join("-");if(!i||a===i||!a.startsWith(i)){if(n.selections){var c=n.selections.filter(function(n){return ue(e,n)});return oe(e,n,!1)&&(i=a),r.__assign({},n,{selections:c})}return null}}}}))}function ce(e){return function(n){return e.some(function(e){return n.value&&"Variable"===n.value.kind&&n.value.name&&(e.name===n.value.name.value||e.test&&e.test(n))})}}function fe(e,t){var i=ce(e);return $(n.visit(t,{OperationDefinition:{enter:function(n){return r.__assign({},n,{variableDefinitions:n.variableDefinitions.filter(function(n){return!e.some(function(e){return e.name===n.variable.name.value})})})}},Field:{enter:function(n){if(e.some(function(e){return e.remove})){var t=0;if(n.arguments.forEach(function(e){i(e)&&(t+=1)}),1===t)return null}}},Argument:{enter:function(e){if(i(e))return null}}}))}function le(e,t){function r(n){if(e.some(function(e){return e.name===n.name.value}))return null}return $(n.visit(t,{FragmentSpread:{enter:r},FragmentDefinition:{enter:r}}))}function se(e){var n=[];return e.selections.forEach(function(e){(D(e)||k(e))&&e.selectionSet?se(e.selectionSet).forEach(function(e){return n.push(e)}):"FragmentSpread"===e.kind&&n.push(e)}),n}function ve(e){return"query"===W(e).operation?e:n.visit(e,{OperationDefinition:{enter:function(e){return r.__assign({},e,{operation:"query"})}}})}function pe(e){L(e);var t=ne([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=n.visit(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every(function(e){return D(e)&&"__typename"===e.name.value}))return null}}})),t}var me="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product),de=Object.prototype.toString;function ge(e){return ye(e,new Map)}function ye(e,n){switch(de.call(e)){case"[object Array]":if(n.has(e))return n.get(e);var t=e.slice(0);return n.set(e,t),t.forEach(function(e,r){t[r]=ye(e,n)}),t;case"[object Object]":if(n.has(e))return n.get(e);var r=Object.create(Object.getPrototypeOf(e));return n.set(e,r),Object.keys(e).forEach(function(t){r[t]=ye(e[t],n)}),r;default:return e}}function he(){return"undefined"!=typeof process?"production":"development"}function be(e){return he()===e}function xe(){return!0===be("production")}function Oe(){return!0===be("development")}function De(){return!0===be("test")}function ke(e){try{return e()}catch(e){console.error&&console.error(e)}}function Fe(e){return e.errors&&e.errors.length}function je(e,n){if(e===n)return!0;if(e instanceof Date&&n instanceof Date)return e.getTime()===n.getTime();if(null!=e&&"object"==typeof e&&null!=n&&"object"==typeof n){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(!Object.prototype.hasOwnProperty.call(n,t))return!1;if(!je(e[t],n[t]))return!1}for(var t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&!Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}function Se(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(n){null===e[n]||"object"!=typeof e[n]&&"function"!=typeof e[n]||Object.isFrozen(e[n])||Se(e[n])}),e}function Ee(e){if((Oe()||De())&&!("function"==typeof Symbol&&"string"==typeof Symbol("")))return Se(e);return e}var Ve=Object.prototype.hasOwnProperty;function _e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return we(e)}function we(e){var n=e[0]||{},t=e.length;if(t>1){var r=[];n=qe(n,r);for(var i=1;i<t;++i)n=Ne(n,e[i],r)}return n}function Ie(e){return null!==e&&"object"==typeof e}function Ne(e,n,t){return Ie(n)&&Ie(e)?(Object.isExtensible&&!Object.isExtensible(e)&&(e=qe(e,t)),Object.keys(n).forEach(function(r){var i=n[r];if(Ve.call(e,r)){var o=e[r];i!==o&&(e[r]=Ne(qe(o,t),i,t))}else e[r]=i}),e):n}function qe(e,n){return null!==e&&"object"==typeof e&&n.indexOf(e)<0&&(e=Array.isArray(e)?e.slice(0):r.__assign({__proto__:Object.getPrototypeOf(e)},e),n.push(e)),e}var Pe=Object.create({});function Ae(e,n){void 0===n&&(n="warn"),xe()||Pe[e]||(De()||(Pe[e]=!0),"error"===n?console.error(e):console.warn(e))}function Me(e){return JSON.parse(JSON.stringify(e))}exports.addTypenameToDocument=te,exports.argumentsObjectFromField=x,exports.assign=T,exports.buildQueryFromSelectionSet=ve,exports.canUseWeakMap=me,exports.checkDocument=L,exports.cloneDeep=ge,exports.createFragmentMap=H,exports.getDefaultValues=U,exports.getDirectiveInfoFromField=_,exports.getDirectiveNames=I,exports.getDirectivesFromDocument=ae,exports.getEnv=he,exports.getFragmentDefinition=R,exports.getFragmentDefinitions=C,exports.getFragmentQueryDocument=M,exports.getInclusionDirectives=A,exports.getMainDefinition=W,exports.getMutationDefinition=J,exports.getOperationDefinition=Q,exports.getOperationDefinitionOrDie=z,exports.getOperationName=B,exports.getQueryDefinition=K,exports.getStoreKeyName=b,exports.graphQLResultHasError=Fe,exports.hasClientExports=q,exports.hasDirectives=N,exports.isDevelopment=Oe,exports.isEnv=be,exports.isEqual=je,exports.isField=D,exports.isIdValue=F,exports.isInlineFragment=k,exports.isJsonValue=S,exports.isNumberValue=u,exports.isProduction=xe,exports.isScalarValue=o,exports.isTest=De,exports.maybeDeepFreeze=Ee,exports.mergeDeep=_e,exports.mergeDeepArray=we,exports.removeArgumentsFromDocument=fe,exports.removeClientSetsFromDocument=pe,exports.removeConnectionDirectiveFromDocument=ie,exports.removeDirectivesFromDocument=ne,exports.removeFragmentSpreadFromDocument=le,exports.resultKeyNameFromField=O,exports.shouldInclude=w,exports.storeKeyNameFromField=y,exports.stripSymbols=Me,exports.toIdValue=j,exports.tryFunctionOrLogError=ke,exports.valueFromNode=V,exports.valueToObjectRepresentation=g,exports.variablesInOperation=G,exports.warnOnceInDevelopment=Ae;
